<!DOCTYPE html>
<html lang="en">

<head>
  <title>IPsaur</title>
  <meta charset="UTF-8" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/client.css" />
  <script src="/client.js"></script>
</head>

<body>
  <img id="logo" class="bounce" style="position: absolute" src="data:image/png;base64,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" />
  <div style="padding-left: 60px" class="box menu">
    <span class="bold"><span style="font-size: 20px">IPsaur</span></span>
    <div class="bold">
      <span id="results_to_clipboard">[<a href="javascript:void(0)"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1ElEQVR4nO3aMQ6DMBBEUVc5ecDknsAZkupHSKC4IQ5mHSztvBqsHe0IGocgH0APvDhueacLraAsxOZZe7gb8ADmvQmSZ0/54ZwJGJaZSoIMBgNYBdnEkiC7m7gwyFwSxHIAs3OCgiT+/dWi1ka+PNud+I/cmwlSCwqS0EYMoWolVC1DqFqeq4URBclxV62aUBDPG8GIguS4q1ZNKIjnjWBEQXLcVasmFCShjRhC1UqoWoZQtbxUqwXBc5CJ9owlQSLt6UvvosRGNjOuN5CO30WRcI032/CwcRZMTXIAAAAASUVORK5CYII=" width="22px" />To
          Clipboard</a>]</span>
      <!-- <span>[<a href="javascript:toggleShareBlock()"><img src="share.png" width="22px" />Share results</a>]</span> -->
      <span>[<a href="javascript:toggleShareBlock()"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC40lEQVR4nN2az2oTURTGx9YUFQQR/P8Gii8hLtVaja2KqAsFn6FbwTYi9V+FbsVaU124ER/Fpq0xdSmiSG2iG/uTS76B6ZDJzM3MZG7yQaAk95zcr/ecc8/5Jp7nEIAxYApYAmrAll41vTdp1nguAygDX4jHZ2DCcw3ACPAIe1SMrecKeiThY9ZzAcBl0uOiC4lt4j0t6oUWAFWgrFAukkg1QyKLRRJZy5BIrUgizQyJbPZ787uBUf39Z+CI0CZwC1gHTuu9xsCEFm0CN0P5cE2fvcuQyKu8CIx2IODjhdZcd7b80u6brqhbjcIvYJ8uxEauFyLtL5kMtdMtYANYBq4GjXUCN4DVhF9+L6MWZRu4EEXikljGoeG30zqJRYsN/ASOyfZJCiIzUWHxsAdnc8AuJfYHC7uPshmRDxuYk5jt2Mb3SMLHnHwcBn5Y2FUD98p4wsHKFJDxbuGUFn6Y3U24vqWwOhDYR0nF4o1ImTW/gU+mxGqKLHVL7CQ5EYcNbWRPzKmYG/2pnyOuttNT8jnfhcDxTAn4UInNCsvyWQ4ReJYbAR8WtT8J6vJ5CvgLPAdOeP0AsJkhkZZ8lvpGYBiJrOYQWif7lhs+gNcZEql26KHyKbd9Kr/mJMIwl9tj4KjnuL7UUG4Yf9+7rGuptzqSB5mJlCT+AWfk63ZCm6bk0v2hf2o51KLYqfEShXvFffk4CHyzsHvpd7DAuYStUnc1Xu10pYd2ejpgbzOHvw90vtPylZ0ab0RhqR1xMEd/XjZmHlmw2ITJoUOyfWC1/Z2oxIVZSbFqpr4VtdJNHf2SWu3wqOvLPUlwR3ZnlV9uqfHs1K+6jbl7ldhfSY/1yBklZ0LzzstBCQn5At3bgVPjGXTJdOhE7DBUrrcGnohBjKxqixWvKKifcluNTwJdqkPxMHQso+eI9cJ/n6K+Lh81vt9IOT7MeK6gx6cA25FqfNGwGB/WItV4VxBQ44PjQyI1/j9xT3eDmT1onQAAAABJRU5ErkJggg==" width="22px" />Share results</a>]</span>
      <!-- <span>[<a href=""><img src="github.png" width="22px" /> Github</a>]</span> -->
      <span>[<a href=""><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAACi0lEQVR4nJ3VW+jPdxgH8J/TBUrKIUuR5hAp1MytWhqFGRcUyoUxkbJw40ZIahe0DCkzN1tNMYdCUg4pqW2kjBxbxnJaI+fDSw/Pd338+/3+B0996/uc3s/z+byfz+dTq7Ug6IAxmIkl+cX/p+FrKb854CH4AXc0lvBtw+C2AHfFFrzAf9iOqQGSvq75Pw0/4kHGbkKXlsD74w+8xHr0bEVDvbAhc35Hv0aBPXApu57U6iWn4HPcx1X0bursiBN4hE+wAndxAOMzpjsG4mN0S9tEHMK9JH80HuPYewOAeUnajNT/wgVcL8isR3DIZVzB+cydlfa5FXhn3MLRouBTrEEnLEoyl2bybCxL2/xc/eZYRZF/HDcDO5QpWfGzdLbP7fnpvX1sRrAHN9Au9XGJOTmUHbnct3uGOemc3YYCX2XO9ILTaHJ7KGexuwg+gjOtBQ+JznER+wrbrzHytex+Y+EIgrfV2ij4OYoU+kbcjp9nWFc4YiJ2fECBnThX6GtjWGrJ9v+AOddt2qKQPKS7Cn0r/q5G6mThWJiEja1sLUkeuJA5he3U29HPeX+Fj+KywtAkLLj5ohq9BsAx0tPxb95hnYpr5zlWhTI8qy9LguVxr+RWTAcmFMBf5jVyO2Oi276FP7BeY1hlOJxdRFIlsapf8Fvq3xYA36VtfxymWEnh65GrP1gudVhOU8zu6bzfzzYpNqqI75v2+XW2bFdiveu+cC7OpAp4Z95Dy+N5rLP/0cTqJuDfZ+7iRqStU1+u1Il9WRVAH+zN2LWNhqJKXJC3acifycHDOnGxbfG0rkz+nuDrZsGL5EE5OTEJIdfqxPxT8LM7HqJWgTcBiRfsG4yo4xsZjwoGNAfyBrrYVblVzaxPAAAAAElFTkSuQmCC" width="22px" /> Github</a>]</span>
      <!-- <span>[<a href=""><img src="heart.png" width="22px" />Donate</a>]</span> -->
      <span>[<a href=""><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAACDUlEQVR4nO3ZvWsTYRzA8bNWoYqigv+B1lIUBQUnxc1FUBwcOzopKuLLqgi6KgWF4mIVBP8DG118QQWhFEVxcawvIEg6+EY+cvgUQrweueSa3AP5wkGG5Ec+XPLk8lySDBo0aNCgKodtuIAa3mEBPzGPx7iEnQXm7cLl8Nr5MGshzJ7BeYyWCdiDR9rvCfbnzDuApwXm1bC7G8AqTKKheOlrbmGkad4IpjqYtTjvBoaLIjaGU95tz8OsTXhRwrwaNhQ5E2UgFnsWQGVVa+vMhI9T1bvezhe7k+9Er2vkLgAFV6d+N7MUYkx8jWZBLoqvc1mQ9Nc0th5mQT6Ir/dZkLr4qmdB0ou22PqRBfkqvj5nQebE12wW5L74upcFOSu+TmdBtouvsf8gAfNGPM1lIgLklHg6mQdZmy5pqt8XrFsSEjBnVL8TuYgAGcZr1W227U0I7Ah7TFWrnq6ubSGaMEcr9re3gWOFEE2Yq6rTlY4QAbISd/stwB0MdQwJmCHc7iNiqmtEC+ZmHxCTWFEKogV0HL97APiT7vyXDmjBHMS3ZUR8x6FlRTRhtuLVMiBeYktPEC1XAOmNn18lANKP6zWs7imiBbS3y62kj9iXVCGsSXfIO/x9yL+K7Uc4gk9tANLnHE6qnH93qKZzEA+wOYklTLRcQaePJ5IYwzjehmM8iTmsT49+v49BSY/7C4NWh4chZ3uhAAAAAElFTkSuQmCC" width="22px" />Donate</a>]</span>
    </div>
  </div>
  <div id="share_block" style="display: none" class="box">
    The test results will be shared.<br />
    Please read and accept the data sharing terms and conditions below.<br />
    <div id="data_sharing_conditions">
      Test results will be stored on our servers.<br /><br />
      Data will be automatically removed from our servers after 30 days.<br /><br />
      You will receive the DeleteKey to delete the shared data. Please keep it
      secure and don't share with others. You won't be able to recover the
      DeleteKey if it is lost.<br /><br />
      [<input id="share_accepted" type="checkbox" onchange="shareAccepted(this.checked)" />]<label for="share_accepted">
        I accept the data sharing terms and conditions.</label>
    </div>
    <div id="do_share" style="display: none">
      Comment (optional):<br /><textarea style="
            width: 100%;
            height: 5em;
            background-color: #111;
            color: #ddd;
            font-size: 14px;
          "></textarea><br />
      [<a href="javascript:doShare()">Give me the URL and password</a>]<br /><br />
    </div>
    <div id="share_data" style="display: none">
      <br />
      Url:
      <span id="share_url" class="underline" style="overflow-wrap: anywhere">https://share.url/s/base64hash</span>
      <span id="share_url_a">[<a href="javascript:void(0)"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1ElEQVR4nO3aMQ6DMBBEUVc5ecDknsAZkupHSKC4IQ5mHSztvBqsHe0IGocgH0APvDhueacLraAsxOZZe7gb8ADmvQmSZ0/54ZwJGJaZSoIMBgNYBdnEkiC7m7gwyFwSxHIAs3OCgiT+/dWi1ka+PNud+I/cmwlSCwqS0EYMoWolVC1DqFqeq4URBclxV62aUBDPG8GIguS4q1ZNKIjnjWBEQXLcVasmFCShjRhC1UqoWoZQtbxUqwXBc5CJ9owlQSLt6UvvosRGNjOuN5CO30WRcI032/CwcRZMTXIAAAAASUVORK5CYII=" width="22px" />Clip</a>]</span><br />
      DeleteKey:
      <span id="share_password" class="grey" style="overflow-wrap: anywhere">P@$$w0rd</span>
      <span id="share_password_a">[<a href="javascript:void(0)"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1ElEQVR4nO3aMQ6DMBBEUVc5ecDknsAZkupHSKC4IQ5mHSztvBqsHe0IGocgH0APvDhueacLraAsxOZZe7gb8ADmvQmSZ0/54ZwJGJaZSoIMBgNYBdnEkiC7m7gwyFwSxHIAs3OCgiT+/dWi1ka+PNud+I/cmwlSCwqS0EYMoWolVC1DqFqeq4URBclxV62aUBDPG8GIguS4q1ZNKIjnjWBEQXLcVasmFCShjRhC1UqoWoZQtbxUqwXBc5CJ9owlQSLt6UvvosRGNjOuN5CO30WRcI032/CwcRZMTXIAAAAASUVORK5CYII=" width="22px" />Clip</a>]</span><br />
    </div>
  </div>
  <div id="error_block" class="box" style="display: none"></div>
  <div id="terminal" class="box terminal"></div>
  <div id="nettest" class="box">
    <span class="magenta bold">Network Bandwidth Test</span><br />
    <div class="terminal">Round-Trip Time: <span id="rtt_primary"></span></div>
    <div class="terminal">Download Speed: <span id="dl_primary"></span></div>
    <div class="terminal">Upload Speed: <span id="ul_primary"></span></div>
  </div>
  <!-- <div id="test_timestamp" class="box"></div> -->
</body>

<script>
  async function addTextToClipboard(id) {
    const element = document.querySelector("#" + id);
    await navigator.clipboard.writeText(element.innerHTML);
  }
  const test_results = {
    ip: {},
    nettest: {},
    browsertimeutc: "",
    browsertimelocal: "",
  };
  document
    .getElementById("results_to_clipboard")
    .addEventListener(
      "click",
      async () => {
        await navigator.clipboard.writeText(JSON.stringify(test_results, undefined, 2))
        // const el = document.getElementById("results_to_clipboard");
        // const old_h = el.innerHTML;
        // el.innerText = 'Copied';
        // setTimeout(() => {
        //   el.innerHTML = old_h;
        // }, 1000);
      }
    );
  document
    .getElementById("share_url_a")
    .addEventListener(
      "click",
      async () => await addTextToClipboard("share_url")
    );
  document
    .getElementById("share_password_a")
    .addEventListener(
      "click",
      async () => await addTextToClipboard("share_password")
    );

  window.addEventListener("load", async () => {
    const terminal = document.getElementById("terminal");
    try {
      const ts = new Date();
      test_results.browsertimeutc = ts.toJSON();
      test_results.browsertimelocal = ts.toString();
      const rsp = await fetch("/json");
      const ip_data = await rsp.json();
      test_results.ip = ip_data;
      let text = `\x1b[1;35mIP Address\x1b[0m  \x1b[1;4;32m${ip_data.ip}\x1b[0m\n`;
      text += `\x1b[1;33mUser agent\x1b[0m  ${ip_data.ua}\n`;

      if (ip_data.ip_details.asn || ip_data.ip_details.city) {
        text += "\n\x1b[1;36mIP Geolocation Details\x1b[0m Provided by: ";
        if (ip_data.providers.dbip) text += "DB-IP (https://db-ip.com) ";
        if (ip_data.providers.maxmind) {
          text += "MaxMind (https://www.maxmind.com)";
        }
        text += "\n";

        if (ip_data.ip_details.asn) {
          text += `  Provider: ${ip_data.ip_details.asn.autonomous_system_organization} (AS${ip_data.ip_details.asn?.autonomous_system_number})\n`;
        }
        if (ip_data.ip_details.city) {
          text += `  Country:  ${ip_data.ip_details.city.continent?.code} ${ip_data.ip_details.city.country?.iso_code} - ${ip_data.ip_details.city.country?.names.en}\n`;
          text += `  City:     ${ip_data.ip_details.city.city?.names.en}\n`;
        }
      }
      text +=
        "\nServer time (UTC): " + new Date(ip_data.servertime).toUTCString() + "\n";
      text +=
        "Browser time (Local): " + ts.toString(); + "\n";
      printTextEl(terminal, text);
      test_results.nettest = await testBandwidth("primary");
    } catch (err) {
      const err_block = document.getElementById("error_block") || terminal;
      err_block.style.display = "block";
      printTextEl(
        err_block,
        `\x1b[1mOoops... There's something happened in IPsaur's land.\x1b[0m\n\n\x1b[1;31mError details:\x1b[0m\n${err.stack}`
      );
    }
  });
</script>

</html>
