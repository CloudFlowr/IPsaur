<!DOCTYPE html>
<html lang="en">

<head>
  <title>IPsaur - Shared result</title>
  <meta charset="UTF-8" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/client.css" />
  <script src="/client.js"></script>
</head>

<body>
  <img id="logo" class="bounce" style="position: absolute"
    src="data:image/png;base64,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" />
  <div style="padding-left: 60px" class="box menu">
    <span class="bold"><span style="font-size: 1.2em">IPsaur</span></span>
    <div class="bold">
      <span id="results_to_clipboard">[<a href="javascript:void(0)"><img
            src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1ElEQVR4nO3aMQ6DMBBEUVc5ecDknsAZkupHSKC4IQ5mHSztvBqsHe0IGocgH0APvDhueacLraAsxOZZe7gb8ADmvQmSZ0/54ZwJGJaZSoIMBgNYBdnEkiC7m7gwyFwSxHIAs3OCgiT+/dWi1ka+PNud+I/cmwlSCwqS0EYMoWolVC1DqFqeq4URBclxV62aUBDPG8GIguS4q1ZNKIjnjWBEQXLcVasmFCShjRhC1UqoWoZQtbxUqwXBc5CJ9owlQSLt6UvvosRGNjOuN5CO30WRcI032/CwcRZMTXIAAAAASUVORK5CYII=" />To
          clipboard</a>]</span>
    </div>
  </div>
  <div id="error_block" class="box" style="display: none"></div>
  <div id="terminal" class="box terminal"></div>
  <div id="nettest" class="box"><span class="magenta bold">Network Bandwidth Test</span><br />
    Round-Trip Time: <span id="rtt_primary">---</span><br />
    Download Speed: <span id="dl_primary">---</span><br />
    Upload Speed: <span id="ul_primary">---</span><br />
  </div>
  <div id="links_block" class="box menu">
    <% links.forEach(link=> { %>
      <span class="nowrap">[<a href="<%= link.url %>" target="_blank"><img src="<%= link.icon %>" width1="22px" />
          <%= link.name %>
        </a>]</span>
      <% }) %>
  </div>
</body>

<script>
  const terminal = document.getElementById("terminal");
  const nettest = document.getElementById("nettest");
  const error_block = document.getElementById("error_block");
  async function addTextToClipboard(text, span_el = null) {
    await navigator.clipboard.writeText(text);
    if (span_el) {
      const tooltip_el = document.createElement("span");
      tooltip_el.classList.add('box', 'tooltip');
      tooltip_el.innerText = 'Copied';
      span_el.prepend(tooltip_el);
      setTimeout(() => {
        span_el.removeChild(tooltip_el);
      }, 1000);
    }
  }
  const results_to_clipboard_el = document.getElementById("results_to_clipboard")
  results_to_clipboard_el.addEventListener("click",
    async () => {
      addTextToClipboard(
        terminal.innerText + "\n\n" +
        nettest.innerText + "\n\n" +
        error_block.innerText, results_to_clipboard_el);
    }
  );
  window.addEventListener("load", async () => {
    try {
      const text = `<%= text_response.replaceAll('\`', '\\\`') %>`;

      printTextEl(terminal, text);
      const saved_error = `<% saved_error.replaceAll('\`', '\\\`') %>`;
      if (saved_error !== '') printTextEl(err_block,
        "\x1b[1mError saved in shared result\x1b[0m\n\n\x1b[1;31mError details:\x1b[0m\n" + saved_error
      );

      document.getElementById('rtt_primary').innerText = "<%= rtt %>";
      document.getElementById('dl_primary').innerText = "<%= dl_speed  %>";
      document.getElementById('ul_primary').innerText = "<%= ul_speed  %>";

    } catch (err) {
      const err_block = document.getElementById("error_block") || terminal;
      err_block.style.display = "block";
      printTextEl(
        err_block,
        "\x1b[1mOoops... There's something happened in IPsaur's land.\x1b[0m\n\n\x1b[1;31mError details:\x1b[0m\n" + err.stack
      );
    }
  });
</script>

</html>
